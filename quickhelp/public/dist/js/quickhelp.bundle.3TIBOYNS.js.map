{
  "version": 3,
  "sources": ["../../../../../apps/quickhelp/quickhelp/public/js/file_uploader.js", "../../../../../apps/quickhelp/quickhelp/public/js/support_ticket.js", "../../../../../apps/quickhelp/quickhelp/public/js/custom_ticket_button.js"],
  "sourcesContent": ["// Copyright (c) 2025, KlyONIX Tech Consulting Pvt Ltd and contributors\n// For license information, please see license.txt\n\nfrappe.provide(\"quickhelp\");\n\nquickhelp.UploadFile = function (file) {\n    return new Promise((resolve, reject) => {\n        let xhr = new XMLHttpRequest();\n        xhr.upload.addEventListener('loadstart', (e) => {\n            frappe.show_alert({\n                indicator: 'green',\n                message: __('Uploading file.')\n            })\n        })\n        xhr.upload.addEventListener('progress', (e) => {\n            if (e.lengthComputable) {\n                console.log(`Upload in progress. ${e.loaded} / ${e.total}`)\n                frappe.show_progress(\"Uploading\", e.loaded, e.total, \"\", true);\n            }\n        })\n        xhr.addEventListener('error', (e) => {\n            frappe.show_alert({\n                indicator: 'red',\n                message: __('Error uploading file.')\n            })\n            console.log(e);\n            reject();\n        })\n        xhr.onreadystatechange = () => {\n            if (xhr.readyState == XMLHttpRequest.DONE) {\n                if (xhr.status === 200) {\n                    let r = null;\n                    let file_doc = null;\n                    try {\n                        r = JSON.parse(xhr.responseText);\n                        if (r.message.doctype === 'File') {\n                            file_doc = r.message;\n                        }\n                    } catch (e) {\n                        console.log(xhr.responseText);\n                        frappe.show_alert({\n                            indicator: 'red',\n                            message: __('Error uploading file.')\n                        })\n                        reject();\n                    }\n                    resolve(file_doc.file_url);\n                } else {\n                    let error = null;\n                    try {\n                        error = JSON.parse(xhr.responseText);\n                        console.log(error)\n                    } catch (e) {\n                        // pass\n                        console.log(xhr.responseText)\n                    }\n                    frappe.show_alert({\n                        indicator: 'red',\n                        message: __('Error uploading file.')\n                    })\n                    reject();\n                }\n            }\n        }\n        xhr.open('POST', '/api/method/upload_file', true);\n        xhr.setRequestHeader('Accept', 'application/json');\n        xhr.setRequestHeader('X-Frappe-CSRF-Token', frappe.csrf_token);\n\n        let form_data = new FormData();\n        form_data.append('file', file, `screen-rec-${Date.now()}.mp4`);\n        form_data.append('is_private', frappe.boot.quickhelp_file_type);\n        form_data.append('folder', 'Home/QuickHelp');\n\n        xhr.send(form_data);\n    });\n}", "// Copyright (c) 2025, KlyONIX Tech Consulting Pvt Ltd and contributors\n// For license information, please see license.txt\n\nfrappe.provide(\"quickhelp\");\n\nquickhelp.SupportTicket = class {\n    constructor() {\n        if (!frappe.boot.quickhelp_support_enabled) {\n            frappe.msgprint({\n                title: __(\"Support Disabled\"),\n                message: __(\"Support is not enabled for this site. Please contact Administrator.\"),\n                indicator: \"red\"\n            });\n            return;\n        }\n\n        if (frappe.session.user === \"Administrator\") {\n            frappe.msgprint({\n                title: __(\"Access Denied\"),\n                message: __(\"Administrator cannot create support tickets.\"),\n                indicator: \"orange\"\n            });\n            return;\n        }\n\n        this.inUpload = false;\n        this.init_config();\n        this.setup_dialog();\n        this.dialog?.show?.();\n    }\n\n    init_config() {\n        this.fields = [\n            {\n                label: \"Ticket Title\",\n                fieldname: \"ticket_title\",\n                fieldtype: \"Data\",\n                reqd: 1,\n\t\tplaceholder: __(\"Enter a brief description of the issue\"),\n\t\tdescription: __(\"Summarize the issue in a few words.\")\n            },\n            {\n                label: \"Module\",\n                fieldname: \"ticket_module\",\n                fieldtype: \"Select\",\n                options: [\"Accounts\", \"Buying\", \"Selling\", \"HR\", \"Stock\", \"Projects\", \"CRM\", \"Others\"],\n                reqd: 1,\n\t\tplaceholder: __(\"Select the module related to the issue\"),\n\t\tdescription: __(\"Choose the module where the issue is occurring.\")\n            },\n            {\n                label: \"Description\",\n                fieldname: \"ticket_description\",\n                fieldtype: \"Text Editor\",\n                reqd: 1,\n\t\tplaceholder: __(\"Provide a detailed description of the issue\"),\n\t\tdescription: __(\"<b>Include steps to reproduce, error messages, Screenshots and any other relevant details.<b>\")\n            }\n        ];\n    }\n\n    setup_dialog() {\n        this.dialog = new frappe.ui.Dialog({\n            title: __(\"Create Support Ticket\"),\n            fields: this.fields,\n            primary_action_label: __(\"Submit\"),\n            primary_action: (values) => {\n                this.raise_ticket(values);\n            }\n        });\n    }\n\n    async raise_ticket(values) {\n        if (this.inUpload) return;\n\n        this.inUpload = true;\n\n        frappe.call({\n            method: \"quickhelp.utils.support.create_ticket\",\n            type: \"POST\",\n            args: {\n                \"title\": values.ticket_title,\n                \"raised_by\": frappe.session.user,\n                \"ticket_module\": values.ticket_module,\n                \"description\": values.ticket_description\n            },\n            freeze: true,\n            freeze_message: __(\"Creating ticket...\"),\n            callback: (r) => {\n                this.inUpload = false;\n                console.log(\"Create ticket response:\", r);\n\n                if (r.message) {\n                    frappe.msgprint({\n                        title: __(\"\uD83C\uDFAB Ticket Created Successfully\"),\n                        message: __(`\uD83C\uDFAB Your ticket (#${r.message}) has been created successfully. You can track it from the Support Portal.`),\n                        indicator: \"green\"\n                    });\n\n                    this.dialog?.hide?.();\n                }\n            },\n            error: (err) => {\n                this.inUpload = false;\n                console.error(\"Ticket creation error:\", err);\n                frappe.show_alert({\n                    indicator: \"red\",\n                    message: __(\"\u274C An error occurred while creating the ticket.\")\n                });\n            }\n        });\n    }\n};", "// Copyright (c) 2025, KlyONIX Tech Consulting Pvt Ltd and contributors\n// For license information, please see license.txt\n\nfrappe.after_ajax(() => {\n\tconst button = document.createElement(\"button\");\n\tbutton.id = \"quickhelp-ticket-button\";\n\tbutton.innerHTML = '<i class=\"fa fa-ticket\"></i> Create Ticket';\n\tbutton.style.position = \"fixed\";\n\tbutton.style.bottom = \"20px\";\n\tbutton.style.right = \"20px\";\n\tbutton.style.zIndex = \"1000\";\n\tbutton.style.padding = \"10px 20px\";\n\tbutton.style.backgroundColor = \"#28a745\";\n\tbutton.style.color = \"#fff\";\n\tbutton.style.border = \"none\";\n\tbutton.style.borderRadius = \"5px\";\n\tbutton.style.cursor = \"pointer\";\n\tbutton.style.boxShadow = \"0 2px 5px rgba(0, 0, 0, 0.2)\";\n    \n\t// Append the button to the body\n\tdocument.body.appendChild(button);\n    \n\t// Add click event to trigger the ticket creation popup\n\tbutton.addEventListener(\"click\", function() {\n\t    new quickhelp.SupportTicket();\n\t});\n    });"],
  "mappings": "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",
  "names": ["file", "resolve", "reject", "xhr", "e", "r", "file_doc", "error", "form_data", "_a", "_b", "values", "err", "button"]
}
